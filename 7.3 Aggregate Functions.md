# üìò AGGREGATE FUNCTIONS

## SQL Server (SSMS)

---

## 1Ô∏è‚É£ What are Aggregate Functions?

**Aggregate functions** are SQL functions used to **perform calculations on a set of rows** and return **a single summarized value**.

üëâ They operate on **multiple rows**
üëâ They return **one value per group**
üëâ Commonly used with **GROUP BY**

---

## 2Ô∏è‚É£ Why Aggregate Functions are Important?

Aggregate functions are used to:

* Generate reports
* Summarize large data
* Perform analytics
* Answer business questions (total, average, count, etc.)

üëâ **Without aggregates, SQL cannot summarize data.**

---

## 3Ô∏è‚É£ Common Aggregate Functions in SQL Server

| Function | Purpose         |
| -------- | --------------- |
| COUNT()  | Count rows      |
| SUM()    | Total of values |
| AVG()    | Average value   |
| MIN()    | Smallest value  |
| MAX()    | Largest value   |

---

# üîπ COUNT() FUNCTION

---

## 4Ô∏è‚É£ What is COUNT()?

`COUNT()` returns the **number of rows**.

---

### Types of COUNT

| Syntax                 | Meaning                       |
| ---------------------- | ----------------------------- |
| COUNT(*)               | Counts all rows               |
| COUNT(column)          | Counts non-NULL values        |
| COUNT(DISTINCT column) | Counts unique non-NULL values |

---

### Examples

```sql
SELECT COUNT(*) 
FROM tbl_emp;
```

‚û° Counts all rows.

```sql
SELECT COUNT(salary)
FROM tbl_emp;
```

‚û° Ignores NULL salaries.

```sql
SELECT COUNT(DISTINCT dept)
FROM tbl_emp;
```

‚û° Counts unique departments.

---

# üîπ SUM() FUNCTION

---

## 5Ô∏è‚É£ What is SUM()?

`SUM()` returns the **total of numeric values**.

---

### Syntax

```sql
SELECT SUM(column_name)
FROM table_name;
```

---

### Example

```sql
SELECT SUM(salary)
FROM tbl_emp;
```

üìå NULL values are **ignored**.

---

# üîπ AVG() FUNCTION

---

## 6Ô∏è‚É£ What is AVG()?

`AVG()` returns the **average (mean)** of numeric values.

---

### Example

```sql
SELECT AVG(salary)
FROM tbl_emp;
```

üìå NULL values are ignored.

‚ö† AVG returns a **decimal** result.

---

# üîπ MIN() FUNCTION

---

## 7Ô∏è‚É£ What is MIN()?

`MIN()` returns the **lowest value** in a column.

---

### Example

```sql
SELECT MIN(salary)
FROM tbl_emp;
```

‚úî Works with numbers, dates, and strings.

---

# üîπ MAX() FUNCTION

---

## 8Ô∏è‚É£ What is MAX()?

`MAX()` returns the **highest value** in a column.

---

### Example

```sql
SELECT MAX(salary)
FROM tbl_emp;
```

‚úî Works with numbers, dates, and strings.

---

# üîπ AGGREGATES WITH GROUP BY

---

## 9Ô∏è‚É£ Aggregate Functions with GROUP BY

When used with `GROUP BY`, aggregate functions return **one result per group**.

---

### Example

```sql
SELECT dept, SUM(salary) AS TotalSalary
FROM tbl_emp
GROUP BY dept;
```

‚û° Returns department-wise salary total.

---

## üîü Multiple Aggregates Together

```sql
SELECT dept,
       COUNT(*) AS EmpCount,
       SUM(salary) AS TotalSalary,
       AVG(salary) AS AvgSalary
FROM tbl_emp
GROUP BY dept;
```

---

# üîπ WHERE vs HAVING with AGGREGATES

---

## 1Ô∏è‚É£1Ô∏è‚É£ WHERE with Aggregates (Rule)

‚ùå Invalid:

```sql
WHERE SUM(salary) > 50000;
```

‚úÖ Correct:

```sql
HAVING SUM(salary) > 50000;
```

---

## 1Ô∏è‚É£2Ô∏è‚É£ WHERE + GROUP BY + HAVING

```sql
SELECT dept, SUM(salary)
FROM tbl_emp
WHERE dept <> 'HR'
GROUP BY dept
HAVING SUM(salary) > 100000;
```

---

# üîπ AGGREGATES & NULL VALUES

---

## 1Ô∏è‚É£3Ô∏è‚É£ How Aggregates Treat NULL

| Function      | NULL Behavior |
| ------------- | ------------- |
| COUNT(*)      | Counts NULL   |
| COUNT(column) | Ignores NULL  |
| SUM()         | Ignores NULL  |
| AVG()         | Ignores NULL  |
| MIN() / MAX() | Ignores NULL  |

---

# üîπ AGGREGATES WITHOUT GROUP BY

---

## 1Ô∏è‚É£4Ô∏è‚É£ Aggregate Without GROUP BY

```sql
SELECT COUNT(*), SUM(salary)
FROM tbl_emp;
```

‚û° Treats entire table as **one group**.

---

# üîπ AGGREGATES WITH DISTINCT

---

## 1Ô∏è‚É£5Ô∏è‚É£ DISTINCT with Aggregates

```sql
SELECT COUNT(DISTINCT dept)
FROM tbl_emp;
```

‚û° Counts unique departments.

---

# üîπ AGGREGATES & DATA TYPES

---

## 1Ô∏è‚É£6Ô∏è‚É£ Supported Data Types

| Function | Works On              |
| -------- | --------------------- |
| COUNT    | Any                   |
| SUM      | Numeric               |
| AVG      | Numeric               |
| MIN      | Numeric, Date, String |
| MAX      | Numeric, Date, String |

---

# üîπ PERFORMANCE & BEST PRACTICES

---

## 1Ô∏è‚É£7Ô∏è‚É£ Performance Notes 

‚úî Aggregates scan multiple rows
‚úî Indexes help GROUP BY performance
‚úî Filter rows early using WHERE
‚úî Avoid unnecessary GROUP BY
‚úî Use HAVING only when required

---

# üîπ COMMON MISTAKES

---

## 1Ô∏è‚É£8Ô∏è‚É£ Common Aggregate Mistakes

‚ùå Forgetting GROUP BY
‚ùå Using aggregates in WHERE
‚ùå Mixing aggregated and non-aggregated columns
‚ùå Misunderstanding COUNT(*) vs COUNT(column)

---

## üß† One-Line Memory (Interview Gold)

> **Aggregate functions summarize multiple rows into a single value.**
