# üìò DIFFERENT CLAUSES

## SQL Server (SSMS)

---

## 1Ô∏è‚É£ Introduction to Clauses

By using **clauses**, we can provide **additional control** to SQL queries such as:

* Filtering records
* Searching specific data
* Sorting results
* Grouping data
* Fetching limited records

üëâ Clauses **do not modify data**, they only **control how data is retrieved**.

---

## 2Ô∏è‚É£ SQL Server Supported Clauses

SQL Server supports the following important clauses:

* **WHERE**
* **ORDER BY**
* **TOP**
* **DISTINCT**
* **GROUP BY**
* **HAVING**
* **OFFSET ‚Äì FETCH** (Pagination)

---

# üîπ WHERE CLAUSE

## 3Ô∏è‚É£ What is WHERE Clause?

The **WHERE clause** is used to **filter records (rows)** based on a condition.

* Works on **individual rows**
* Condition must return **TRUE or FALSE**
* Used in **SELECT, UPDATE, DELETE**

---

## 4Ô∏è‚É£ WHERE Syntax

```sql
SELECT <Column_List>
FROM <Table_Name>
WHERE <Condition>;
```

---

## 5Ô∏è‚É£ WHERE Examples

```sql
SELECT eid, name, dept
FROM tbl_emp
WHERE address = 'Chennai';
```

```sql
UPDATE tbl_emp
SET salary = 35000
WHERE eid = 1;
```

```sql
DELETE FROM tbl_emp
WHERE eid = 7;
```

üìå WHERE filters rows **before grouping**.

---

# üîπ ORDER BY CLAUSE

## 6Ô∏è‚É£ What is ORDER BY Clause?

The **ORDER BY clause** is used to **sort query results**.

* ASC ‚Üí Ascending (default)
* DESC ‚Üí Descending
* Sorting is **temporary**

---

## 7Ô∏è‚É£ ORDER BY Syntax

```sql
SELECT *
FROM tbl_emp
ORDER BY column_name [ASC | DESC];
```

---

## 8Ô∏è‚É£ ORDER BY Examples

```sql
SELECT *
FROM tbl_emp
ORDER BY name;
```

```sql
SELECT *
FROM tbl_emp
ORDER BY gender DESC, salary ASC;
```

---

### üî∏ ORDER BY with NULL values (IMPORTANT)

* In **ASC**, NULL values come **first**
* In **DESC**, NULL values come **last**

Control NULL sorting:

```sql
ORDER BY 
CASE WHEN salary IS NULL THEN 1 ELSE 0 END,
salary;
```

---

# üîπ TOP CLAUSE

## 9Ô∏è‚É£ What is TOP Clause?

The **TOP clause** is used to fetch **first N records**.

---

## üîü TOP Syntax

```sql
SELECT TOP n *
FROM tbl_emp;
```

---

## 1Ô∏è‚É£1Ô∏è‚É£ TOP Example

```sql
SELECT TOP 3 eid, name, salary
FROM tbl_emp
ORDER BY salary DESC;
```

---

### üî∏ TOP WITH TIES

Returns extra rows if values are equal.

```sql
SELECT TOP 3 WITH TIES *
FROM tbl_emp
ORDER BY salary DESC;
```

üìå If multiple employees have the same 3rd highest salary, all are returned.

---

# üîπ DISTINCT CLAUSE 

## 1Ô∏è‚É£2Ô∏è‚É£ What is DISTINCT?

The **DISTINCT clause** removes **duplicate rows** from the result set.

---

## 1Ô∏è‚É£3Ô∏è‚É£ DISTINCT Syntax

```sql
SELECT DISTINCT column_name
FROM table_name;
```

---

## 1Ô∏è‚É£4Ô∏è‚É£ DISTINCT Example

```sql
SELECT DISTINCT dept
FROM tbl_emp;
```

üìå DISTINCT is applied **before ORDER BY**.

---

# üîπ GROUP BY CLAUSE

## 1Ô∏è‚É£5Ô∏è‚É£ What is GROUP BY Clause?

The **GROUP BY clause** groups **identical values** into a single row.

* Used with aggregate functions:

  * COUNT()
  * SUM()
  * AVG()
  * MIN()
  * MAX()

---

## 1Ô∏è‚É£6Ô∏è‚É£ GROUP BY Syntax

```sql
SELECT column, aggregate_function(column)
FROM table_name
WHERE condition
GROUP BY column;
```

---

## 1Ô∏è‚É£7Ô∏è‚É£ GROUP BY Examples

```sql
SELECT dept, SUM(salary)
FROM tbl_emp
GROUP BY dept;
```

```sql
SELECT dept, SUM(salary)
FROM tbl_emp
GROUP BY dept
ORDER BY dept DESC;
```

---

### üî∏ VERY IMPORTANT GROUP BY RULE

> **Any column in SELECT that is NOT an aggregate function MUST be present in GROUP BY**

‚ùå Invalid:

```sql
SELECT dept, salary
FROM tbl_emp
GROUP BY dept;
```

‚úÖ Valid:

```sql
SELECT dept, SUM(salary)
FROM tbl_emp
GROUP BY dept;
```

---

# üîπ HAVING CLAUSE

## 1Ô∏è‚É£8Ô∏è‚É£ What is HAVING Clause?

The **HAVING clause** filters **grouped (aggregated) data**.

* Works on **groups**
* Used **after GROUP BY**

---

## 1Ô∏è‚É£9Ô∏è‚É£ HAVING Syntax

```sql
SELECT column, aggregate_function(column)
FROM table_name
WHERE condition
GROUP BY column
HAVING condition;
```

---

## 2Ô∏è‚É£0Ô∏è‚É£ HAVING Examples

```sql
SELECT dept, SUM(salary)
FROM tbl_emp
GROUP BY dept
HAVING SUM(salary) > 100000;
```

```sql
SELECT COUNT(eid) AS Count_eid, address
FROM tbl_emp
WHERE address <> 'Hyderabad'
GROUP BY address
HAVING COUNT(eid) >= 1
ORDER BY COUNT(eid) DESC;
```

---

### üî∏ WHERE vs HAVING 

* **WHERE** filters rows **before aggregation** ‚Üí faster
* **HAVING** filters **after aggregation** ‚Üí slower

üëâ Always use WHERE if possible.

---

# üîπ OFFSET ‚Äì FETCH CLAUSE

## 2Ô∏è‚É£1Ô∏è‚É£ What is OFFSET ‚Äì FETCH?

Used for **pagination** (page-wise records).
Available from **SQL Server 2012+**.

---

## 2Ô∏è‚É£2Ô∏è‚É£ OFFSET ‚Äì FETCH Syntax

```sql
SELECT *
FROM table_name
ORDER BY column
OFFSET n ROWS
FETCH NEXT m ROWS ONLY;
```

---

## 2Ô∏è‚É£3Ô∏è‚É£ OFFSET ‚Äì FETCH Example

```sql
SELECT *
FROM tbl_emp
ORDER BY eid
OFFSET 5 ROWS
FETCH NEXT 5 ROWS ONLY;
```

üìå Returns records **6 to 10**.

---

# üîπ ORDER OF EXECUTION (VERY IMPORTANT)

## 2Ô∏è‚É£4Ô∏è‚É£ Logical Execution Order

1. FROM
2. WHERE
3. GROUP BY
4. HAVING
5. SELECT
6. ORDER BY
7. OFFSET / FETCH

---

## üß† One-Line Memory

> **WHERE filters rows, GROUP BY creates groups, HAVING filters groups, ORDER BY sorts, TOP limits, OFFSET paginates**
